<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Hello World!</title>
        <!-- https://electronjs.org/docs/tutorial/security#csp-meta-tag -->
        <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />

        <script>let $ = require('jquery');</script>
        <link rel="stylesheet" type="text/css" href="./style.css">

        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
        <!--    -->

        <!-- Scripts -->
        <script src="formatting.js"></script>
    </head>
    <body>
        <script type="text/javascript">
            var mysql = require('mysql');
            const fs = require('fs');

            const TEST_DATA = [
                {"ID": "1", "FName": "Matt", "MName": "J", "LName": "Raymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "2", "FName": "Mbtt", "MName": "J", "LName": "Rbymond"},
                {"ID": "3", "FName": "Mctt", "MName": "J", "LName": "Rcymond"}
            ]

            var IP_ADDRESS, USER, PASSWORD, DATABASE_NAME;
            var CONNECTION;
            var DATA;


            fs.readFile('./con.data', 'utf8', (err, data) => {
                if (err) {
                    console.error(err)
                    return
                }

                data = data.split(/\r?\n/);

                IP_ADDRESS = data[0];
                USER = data[1];
                PASSWORD = data[2];
                DATABASE_NAME = data[3];

                fnCreateConnection();

                var lstHeader = ["ID", "First Name", "Middle Name", "Last Name"];
                var lstFields = ["ID", "FName", "MName", "LName"];

                fnRunQuery('select * from Student', fnFillData, lstHeader, lstFields, 'grid');

                fnCloseConnection();
            });

            function fnCreateConnection() {
                // Add the credentials to access your database
                CONNECTION = mysql.createConnection({
                    host     : IP_ADDRESS,
                    user     : USER,
                    password : PASSWORD,
                    database : DATABASE_NAME
                });

                CONNECTION.connect();

            }

            function fnCloseConnection() {
                CONNECTION.end();
            }

            function fnRunQuery(strQuery, fncallback, ...rest) {
                CONNECTION.query(strQuery, function(err, rows, fields) {
                  if (err) throw err;

                  fncallback(rows, rest);
                });
            }

            function fnLog() {
                if(typeof(console) !== 'undefined') {
                    console.log.apply(console, arguments);
                }
            }
        </script>
        <h1>Student Information</h1>
        <div id='grid'class="table-container">
        </div>
    </body>
</html>
